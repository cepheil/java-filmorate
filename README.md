# Filmorate


**Filmorate** — это социальный сервис для оценки и рекомендаций фильмов. Пользователи могут добавлять фильмы, ставить им лайки, добавлять других пользователей в друзья и получать рекомендации на основе популярности фильмов.

---

##  Структура базы данных
![postgres(2).png](postgres%282%29.png)

## Краткое описание таблиц

- **`users`** — хранит данные о пользователях:
    - `email` — электронная почта
    - `login` — логин пользователя
    - `name` — имя
    - `birthday` — дата рождения

- **`friendships`** — связи между пользователями:
    - `user_id` — идентификатор пользователя
    - `friend_id` — идентификатор друга
    - `status` — статус дружбы (подтверждена или нет)

- **`films`** — содержит информацию о фильмах:
    - `name` — название
    - `description` — описание
    - `release_date` — дата релиза
    - `duration` — продолжительность
    - `mpa_id` — внешний ключ на рейтинг MPA

- **`ratings_mpa`** — предустановленные рейтинги MPA:  
    - `id` — идентификатор рейтинга
    - `name` — код рейтинга (например, `PG-13`)

- **`genres`** — список жанров фильмов:
    - `id` — идентификатор жанра
    - `name` — название жанра (например, `Комедия`, `Драма`)

- **`film_genre`** — связь "многие-ко-многим" между фильмами и жанрами:
    - `film_id` — идентификатор фильма
    - `genre_id` — идентификатор жанра

- **`likes`** — лайки от пользователей к фильмам:
    - `film_id` — идентификатор фильма
    - `user_id` — идентификатор пользователя

---
## Примеры запросов

| Метод   | URL                                               | Описание                                      |
|---------|---------------------------------------------------|-----------------------------------------------|
| `POST`  | `/users`                                          | Создание нового пользователя                  |
| `PUT`   | `/users`                                          | Обновление пользователя                       |
| `GET`   | `/users`                                          | Получение списка всех пользователей           |
| `GET`   | `/users/{id}`                                     | Получение пользователя по ID                  |
| `PUT`   | `/users/{id}/friends/{friendId}`                  | Добавление пользователя в друзья              |
| `PUT`   | `/users/{id}/friends/{friendId}/confirm`      | Подтверждение дружбы                          |
| `DELETE`| `/users/{id}/friends/{friendId}`                  | Удаление пользователя из друзей               |
| `GET`   | `/users/{id}/friends`                             | Получение списка друзей пользователя          |
| `GET`   | `/users/{id}/friends/common/{otherId}`            | Получение списка общих друзей                 |
| `POST`  | `/films`                                          | Создание нового фильма                        |
| `PUT`   | `/films`                                          | Обновление фильма                             |
| `GET`   | `/films`                                          | Получение списка всех фильмов                 |
| `GET`   | `/films/{id}`                                     | Получение фильма по ID                        |
| `PUT`   | `/films/{id}/like/{userId}`                       | Лайк фильма от пользователя                   |
| `DELETE`| `/films/{id}/like/{userId}`                       | Удаление лайка пользователя у фильма          |
| `GET`   | `/films/popular?count={N}`                        | Получение N самых популярных фильмов          |

---
## Технологии и зависимости

| Технология       | Версия/Описание                                  |
|------------------|--------------------------------------------------|
| Java             | 11+                                              |
| Spring Boot      | 2.7.x                                            |
| Spring Web       | REST API                                         |
| Spring JDBC      | Работа с БД через JDBC                           |
| H2 Database      | Встроенная база данных, режим file (persisted)   |
| Lombok           | Упрощение кода (геттеры/сеттеры и пр.)           |
| Maven            | Управление зависимостями                         |
| JUnit / AssertJ  | Модульное тестирование                           |

---

## Архитектура
Проект реализован по многослойной архитектуре:

- **`Контроллеры (Controller):`** — принимают HTTP-запросы и отдают ответы.

- **`Сервисы (Service):`** — бизнес-логика приложения.

- **`Хранилища (Storage/DAO):`** — работа с БД (JDBC).

- **`Модели (Model):`** — классы-сущности (User, Film, Genre, Mpa).

---